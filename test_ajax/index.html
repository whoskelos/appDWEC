<!doctype html>
<html lang="es">

<head>
    <title>Lista empleados</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS v5.2.1 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.6.2.min.js"
        integrity="sha256-2krYZKh//PcchRtd+H+VyyQoZ/e3EcrkxhM8ycwASPA=" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/78a201790e.js" crossorigin="anonymous"></script>
    <script>
        var libros = [];
        $(document).ready(function () {
            $divPrincipal = $("#principal");
            cargarLibros();
            $(".btn-add").click(divNuevoEmpleado);
        });

        function cargarLibros() {
            $.get("listar.php", {}, (respuesta) => {
                libros = JSON.parse(respuesta);
                pintarLibros(libros);
            });
        }

        function pintarLibros(lista) {
            let tabla = $("#tabla");
            tabla.html(`<thead class="bg-dark text-white">
                <tr>
                    <th scope="col">Identificador</th>
                    <th scope="col">Nombre</th>
                    <th scope="col">apellido</th>
                    <th scope="col">Web</th>
                    <th scope="col">Opciones</th>
                </tr>
            </thead>`);
            $.each(lista, function (index_libro, libro) {
                tabla.append(`<tbody>
                    <tr>
                        <td>${libro.identificador}</td>
                        <td>${libro.nombre}</td>
                        <td>${libro.apellido}</td>
                        <td>${libro.web}</td>
                        <td>
                            <a class="btn btn-danger"><i class="fa-solid fa-trash"></i></a>
                            <a class="btn btn-warning"><i class="fa-solid fa-pen-to-square"></i></<a>
                        </td>
                    </tr>
                </tbody>`);
            });
        }
        function divNuevoEmpleado() {
            if ($("#formNuevoEmpleado")) {
                $("#formNuevoEmpleado").remove();
            }
            $(`<div class="col" id="formNuevoEmpleado">
                    <form>
                        <div class="mb-3">
                            <label for="txtNombre" class="form-label">Nombre empleado</label>
                            <input type="text" class="form-control" id="txtNombre" aria-describedby="emailHelp">
                        </div>
                        <div class="mb-3">
                            <label for="txtApellidos" class="form-label">Apellidos</label>
                            <input type="text" class="form-control" id="txtApellidos">
                        </div>
                        <div class="mb-3">
                            <label for="txtWeb" class="form-label">Web</label>
                            <input type="text" class="form-control" id="txtWeb">
                        </div>
                        <button type="button" class="btn btn-success mb-3" id="btn-registrar">Registrar</button>
                    </form>
                </div>`).appendTo(".row:eq(1)");
                $("#btn-registrar").click(()=>{
                let nombreEmp = $("#txtNombre");
                let apellidosEmp = $("#txtApellidos");
                let webEmp = $("#txtWeb");
                registrarEmpleado(nombreEmp,apellidosEmp,webEmp);
            });
        }
        function registrarEmpleado(nom,ape,webDir) {
            let errores = [];
            if (nom.val() == "") {
                nom.css("border","1px solid red");
                errores.push("Campo nombre vacío");
            }
            if (ape.val() == "") {
                ape.css("border","1px solid red");
                errores.push("Campo apellidos vacío");
            }
            if (webDir.val() == "") {
                webDir.css("border","1px solid red");
                errores.push("Campo web vacío");
            }
            if (errores.length < 0) {
                // $.post("registrar-empleado.php", {nombre: nom},(data,status,xhr)=>{
                //     console.log(status);
                // });
            } else {
                errores.forEach(error => {
                    $(`<div class="alert alert-danger mb-3">${error}</div>`).appendTo("#formNuevoEmpleado");
                });
            }
        }
    </script>

</head>

<body>
    <header>
        <!-- place navbar here -->
        <div class="container">
            <div class="row p-3 flex-column">
                <div class="col">
                    <h1 class="text-center">Lista de empleados</h1>
                </div>
                <div class="col">
                    <button type="button" class="btn btn-primary btn-add">Nuevo empleado</button>
                </div>
            </div>
        </div>
    </header>
    <main>
        <div class="container">
            <div class="row p-3">
                <div class="col" id="principal">
                    <table class="table" id="tabla"></table>
                </div>
            </div>
        </div>
    </main>
    <footer>
        <!-- place footer here -->
    </footer>
    <!-- Bootstrap JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
        integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous">
        </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.min.js"
        integrity="sha384-7VPbUDkoPSGFnVtYi0QogXtr74QeVeeIs99Qfg5YCF+TidwNdjvaKZX19NZ/e6oz" crossorigin="anonymous">
        </script>
</body>

</html>